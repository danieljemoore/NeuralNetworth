# Trading Simulation Game

## Overview

This is a real-time trading simulation game built using React (Vite) for the frontend, a Go backend, and a MongoDB database. 
The game simulates a dynamic trading environment where players can execute trades and react to market fluctuations.
- Advisors:
   Provide advice on when to buy or sell stocks, given by Gemini. Sometimes they are right, sometimes they are wrong.
- News:
   News articles that affect the market. News articles are generated by Gemini and can be positive or negative.
- Companies:
   Companies are listed on the market and have stocks that can be bought or sold. Companies have a ticker symbol, a name, and a value.
- Market:
   Created by Gemini, the market is a dynamic environment that changes every round. The market is influenced by the actions of the players.
- Portfolio:
   Players can view their portfolio, which shows their current holdings and their value.
- Trades:
   Players can execute trades to buy or sell stocks. Trades are executed in real-time and affect the market.
- Rounds:
   The game is played in rounds, with each round representing a day in the market. At the end of each round, the market changes, and players can see how their trades have affected the market, and their portfolio!.

## Tech Stack

- **Frontend:** React (Vite)
- **Backend:** Go (Gin, TBD)
- **Database:** MongoDB
- **Real-time Communication:** WebSockets
- **Authentication:** JWT-based auth
- **Hosting & Deployment:** Cloudflare & TBD

## Setup Guide

### Prerequisites

- Vite, React, Bun, & Tailwindcss  (for frontend dev)
- Go (for backend dev)
- MongoDB (local or cloud)

### Installation

1. Clone the repository:

   ```sh
   git clone --recurse-submodules https://github.com/your-repo/trading-sim.git
   cd trading-sim
   ```

2. Set up the frontend:

   ```sh
   cd frontend
   bun install
   bun run dev
   ```

3. Set up the backend:

   ```sh
   cd backend
   go mod tidy
   go run main.go
   ```

4. Set up MongoDB:
   - If using MongoDB Atlas, configure the `.env` file with your connection string.
   - If running locally, start MongoDB and ensure it’s accessible.

## Contribution Guide

### Code Style

- Follow best practices for Go and React.
- Comment code where necessary, with clear explanations.
- Use meaningful commit messages.
- Run linters before committing.

### Branching

- `main` – stable, production-ready code
- `dev` – active development
- Feature branches should be named `feature/<feature-name>`

## API Documentation

### REST Endpoints

#### Companies

- `GET /api/companies` – Fetch all companies
- `DELETE /api/companies` – Delete ALL data(like literally everything lol)
- `POST /api/generate` – Sends the request to Gemini and populated the company collection
- `POST /api/generate/data` – Populates the company collection with historical data from Gemini

#### Portfolios

- `GET /api/portfolio` – Fetch user portfolio with ?username query
- `POST /api/portfolio` – Create a new portfolio
- `PUT /api/portfolio` – Update an existing portfolio
- `DELETE /api/portfolio` – Delete a portfolio
- `GET /api/portfolios` – Fetch all portfolios
- `DELETE /api/portfolios` – Delete ALL portfolios

#### Trades

- `GET /api/trades` – Fetch all trades
- `POST /api/trades` – Submit a trade
- `DELETE /api/trades` – Delete ALL trades

#### Rounds

- `POST /api/auth/login` – Authenticate user
- `GET /api/game/state` – Fetch game state
- `POST /api/trade` – Submit a trade (fallback for WebSocket issues)

#### WebSocket

- `GET /ws` – WebSocket connection

### WebSocket Events

- `player_joined` – Notifies when a player joins
- `round_ended` – Notifies when a round ends

## Frontend Documentation

### Frontend Directory Structure

```sh
src
├── App.jsx
├── Provider.jsx
├── assets
├── components
│   ├── CompanyList.jsx
│   ├── ThemeButton.jsx
│   └── WebSocketComponent.jsx
├── config
│   └── site.js
├── index.css
├── main.jsx
└── pages
    └── WelcomePage.jsx
```

### Components

- `CompanyList` –
- `WebSocketComponent` -
- `ThemeButton` -

### Pages

## Backend Documentation

### Backend Directory Structure

```sh
backend
├── main.go
├── go.mod
├── go.sum
├── controllers
│   ├── companyController.go (CRUD operations)
│   ├── geminiController.go (API requests to Gemini)
│   ├── portfolioController.go (CRUD operations)
│   ├── roundController.go (CRUD operations)
│   ├── tradeController.go (CRUD operations)
│   └── websocketController.go (WebSocket events)
├── db
│   └── db.go (MongoDB connection)
├── models
│   ├── company.go
│   ├── portfolio.go
│   ├── round.go
│   └── trade.go
└── routes
    ├── companyRoutes.go
    ├── portfolioRoutes.go
    ├── roundRoutes.go
    ├── tradeRoutes.go
    └── websocketRoutes.go
```

## Deployment Guide

- **Frontend:** Deploy via Cloudflare
- **Backend:** Deploy via Fly.io, Railway, or self-hosted VPS **TBD**
- **Database:** Use MongoDB Atlas

## Troubleshooting & FAQs

- The app should be working at **DOMAIN.tech**, but if you're trying to run it locally and you're having issues, here are some common problems and solutions:

### Common Issues

- **Frontend not connecting to backend:** Check WebSocket server URL and CORS settings.
- **Database connection failures:** Verify MongoDB URI and access permissions. The IP whitelist may need updating.
- **Authentication errors:** Ensure JWT secret matches across services.

For further assistance, check the `docs/` folder or open an issue.

Check User:
curl -H GET "http://localhost:5001/api/portfolio?player=user123" | json

Get companies:
curl http://localhost:5001/api/companies

Generate data: curl -X POST "http://localhost:5001/api/generate/data" 

Generate companies: curl -X POST "http://localhost:5001/api/generate"

Make trade:
curl -X POST http://localhost:5001/api/trades/execute -H "Content-Type: application/json" -d '{"player":"user123","company":"NovaTech Solutions","ticker":"NVTS","type":"buy","amount":10}'

Get trades:
curl -X GET http://localhost:5001/api/trades

Clear all data:
curl -X DELETE http://localhost:5001/api/clear
